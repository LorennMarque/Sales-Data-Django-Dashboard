{% extends "layout.html" %}
{% block section %}<i data-feather="truck"></i> Orders {%endblock%}
{% block content %}

<div class="row mb-3">

    <div class="col-lg-8">
        <h4  data-aos="fade-zoom-in">Average Delivery Time per Month (in hrs)</h4>
        
        <div class="card p-3" style="height:55vh" data-aos="fade-zoom-in">
          {% comment %} {{monthly_delivery_time}}  {% endcomment %}
          <canvas  id="monthly_delivery_time"></canvas>
        </div>
      </div>

  <div class="col-lg-4">
    <h4 data-aos="fade-zoom-in" data-aos-delay="100">Avg Delivery Time per Ship Mode </h4>
    <div class="card p-3" style="height:55vh" data-aos="fade-zoom-in" data-aos-delay="150">
      {% comment %} {{avg_delivery_time_per_ship_mode}} {% endcomment %}
      <canvas  id="avg_delivery_time_per_ship_mode"></canvas>
    </div>
  </div>


</div>

<h4 data-aos="fade-zoom-in" data-aos-delay="150">All Orders</h4>
<div class="card p-3" data-aos="fade-zoom-in" data-aos-delay="250">
  {{orders}}
</div> 

{% endblock %}  
<!-- ############################################################################################### -->

    {% block scripts %}
    <script>
      {% comment %} CUARTO GRÁFICO  {% endcomment %}
      var ctx = document.getElementById('avg_delivery_time_per_ship_mode').getContext('2d');
      var data = JSON.parse('{{avg_delivery_time_per_ship_mode|safe}}'); // Asegúrate de pasar correctamente los datos JSON desde Django
      
      var ship_mode = data.map(function(item) {
          return item['Ship Mode'];
      });
      
      var delivery = data.map(function(item) {
          return item['delivery'];
      });
    
      // Define un array de colores
      var colors = ['#8850F1',  '#B48DF9', '#A370F7', '#C3A6FA'];
      
      var myChart = new Chart(ctx, {
          type: 'pie',
          data: {
              labels: ship_mode,
              datasets: [{
                  label: 'Avg delivery time',
                  data: delivery,
                  backgroundColor: colors,
                  fill: false
              }]
          },
          options: {
              indexAxis: 'y',
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero: true
                      }
                  }]
              }
          }
      });
    
    </script>

    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var ctx = document.getElementById('monthly_delivery_time').getContext('2d');
            var data = JSON.parse('{{ monthly_delivery_time|safe }}'); // Asegúrate de pasar correctamente los datos JSON desde Django
        
            var ship_mode = data.map(function(item) {
                return item['date'];
            });
        
            var delivery = data.map(function(item) {
                return item['average_delivery_hours'];
            });
        
            var myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ship_mode,
                    datasets: [{
                        label: 'Avg delivery time',
                        data: delivery,
                        fill: false,
                        pointRadius: 5,
                        pointHoverRadius: 5,
                        borderColor: '#8850F1', // Set the line color to purple
                        backgroundColor: '#8850F1' // Set the point color to purple
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Average Delivery Hours',
                                font: {
                                    size: 16 
                                }
                            },
                            ticks: {
                                font: {
                                    size: 14 
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Month - Year',
                                font: {
                                    size: 16 
                                }
                            },
                            ticks: {
                                font: {
                                    size: 14 
                                }
                            }
                        }
                    }
                }
            });
        });
    </script>
    
      
{% endblock %}